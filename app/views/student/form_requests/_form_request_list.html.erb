<div class="form_request_list" style="padding-top: 2rem">
  <div class="ui dividing header">
    <h3 class="" >Form request</h3>
    <div class="add_btn" onclick="addNewFormRequest()">
      <img src="/assets/add.png" style="width: 1.5em; height: 1.5em; margin-right: 2.5em">
    </div>
  </div>
  <table class="ui very basic table selectable">
    <thead>
      <tr>
        <th>STT</th>
        <th>Form type</th>
        <th>Description</th>
        <th>Note</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      <% @form_requests.each_with_index do |request, index| %>
        <tr onclick="viewMoreFormRequest(<%= request.id %>)">
          <td><%= index + 1 %></td>
          <td>
           <span style="margin: 0 auto; word-wrap: break-word; max-width: 10rem; overflow: hidden; -webkit-line-clamp: 1; -webkit-box-orient: vertical; display: -webkit-box">
              <%= request.form_type %>
            </span>
          </td>
          <td>
            <span style="margin: 0 auto; word-wrap: break-word; max-width: 15rem; overflow: hidden; -webkit-line-clamp: 1; -webkit-box-orient: vertical; display: -webkit-box">
              <%= request.description %>
            </span>
          </td>
          <td>
            <span style="margin: 0 auto; word-wrap: break-word; max-width: 15rem; overflow: hidden; -webkit-line-clamp: 1; -webkit-box-orient: vertical; display: -webkit-box">
              <%= request.note %>
            </span>
          </td>
          <td>
            <% if request.status == "PENDING" %>
              <a class="ui teal tag label" style="width: 7rem"><%= request.status %></a>
            <% elsif request.status == "APPROVED" %>
              <a class="ui blue tag label" style="width: 7rem"><%= request.status %></a>
            <% elsif request.status == "REJECTED" %>
              <a class="ui red tag label" style="width: 7rem"><%= request.status %></a>
            <% end  %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
  <div class="ui modal" id="new_form_request">
    <div class="header">
      <span class="">Request form</span>
      <span class="">
        <div class="ui scrolling dropdown">
          <input type="hidden" name="gender">
          <div class="default text">Select choice</div>
          <div class="menu">
            <div class="item">Choice 1</div>
            <div class="item">Choice 2</div>
          </div>
        </div>
      </span>
    </div>
    <div class="content">
      <div class="ui form">
        <div class="field">
          <label>Title</label>
          <input type="text" placeholder="Enter title">
        </div>
      </div>
      <div class="ui form" style="margin-top:1rem">
        <div class="field">
          <label>Description</label>
          <textarea placeholder="Enter description"></textarea>
        </div>
      </div>
      <%# <button class="ui approved primary basic button" style="margin: 1rem 0; float: right">Primary</button> %>
      <div class="actions" style="display: flex; justify-content: flex-end; margin-top: 1rem">
        <div class="ui cancel button">Submit</div>
      </div>
    </div>
  </div>
  <div class="ui modal" id="form_request_detail">
    <div class="header">Facility Report</div>
    <div class="content">
      <h3 id="request_form_type_show"></h3>
      <p><b>Content:</b></p>
      <p id="request_description_show"></p>
      <p><b>Note:</b></p>
      <p id="request_note_show"></p>
    </div>
    <div class="actions">
      <div class="ui cancel button">Close</div>
    </div>
  </div>
</div>
<script>
  window.onload = function(){
      $('.form_request_list .ui.dropdown').dropdown();
  };
  function addNewFormRequest(){
    $('#new_form_request').modal('show');
  }
  function viewMoreFormRequest(request_id){
    $('#form_request_detail').modal('show');
    $.ajax({
      type: "GET",
      url: `/student/requests/form/${request_id}`,
      data: {
        "id": request_id
      },
      success: function(result){
        $('#request_form_type_show').html(result.form_request.form_type)
        $('#request_description_show').html(result.form_request.description)
        $('#request_note_show').html(result.form_request.note)
      },
      error: function(error){

      }
    })

  }

  const urlParams = new URLSearchParams(window.location.search);
  const focusParam = urlParams.get('focus_id');
  if (focusParam != null) {
    document.querySelector(`#report_${focusParam}`).classList.add("active");
  }
</script>